<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Tr√°miteYA ‚Äì MVP</title>
  <style>
    :root {
      --bg: #F7F7F7;
      --surface: #FFFFFF;
      --ink: #0F172A;
      --muted: #64748B;
      --primary: #0EA5E9;
      --success: #16A34A;
      --danger: #DC2626;
      --radius: 14px;
      --shadow: 0 1px 2px rgba(0,0,0,.08);
      --tap: 44px;
      --gap: 12px;
    }
    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial;
      font-size: 16px;
      line-height: 1.4;
      background: var(--bg);
      color: var(--ink);
      margin: 0;
    }
    header {
      position: sticky;
      top: 0;
      z-index: 10;
      background: var(--ink);
      color: #fff;
      padding: 12px 16px;
      font-weight: 700;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    header .brand {
      font-weight: 800;
      font-size: 18px;
      letter-spacing: 0.5px;
    }
    header .actions {
      display: flex;
      gap: 8px;
    }
    main {
      max-width: 720px;
      margin: 0 auto;
      padding: 12px 16px 24px;
    }
    .card {
      background: var(--surface);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      padding: 16px;
      margin-bottom: 12px;
    }
    .row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: var(--gap);
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px,1fr));
      gap: var(--gap);
    }
    .page-title { font-size:24px; font-weight:800; margin:0 0 12px; }
    .title {
      font-size: 18px;
      font-weight: 700;
      margin: 0 0 6px;
    }
    .big { font-size:16px; font-weight:700; color:#0f172a; }
    .muted {
      color: var(--muted);
      font-size: 13px;
    }
    .btn {
      background: var(--primary);
      color: #fff;
      border: 0;
      border-radius: 10px;
      padding: 10px 14px;
      min-height: var(--tap);
      font-weight: 600;
      cursor: pointer;
      transition: background .2s;
      font-size: 15px;
      box-sizing: border-box;
      outline: none;
    }
    .btn:hover {
      background: #0284c7;
    }
    .btn.secondary {
      background: #E2E8F0;
      color: var(--ink);
    }
    .btn.ghost {
      background: transparent;
      color: var(--primary);
      border: 1px solid var(--primary);
    }
    .btn:disabled {
      opacity: .6;
      cursor: not-allowed;
    }
    input, select {
      width: 100%;
      min-height: var(--tap);
      border: 1px solid #CBD5E1;
      border-radius: 10px;
      padding: 10px;
      font-size: 15px;
      margin-bottom: 8px;
      box-sizing: border-box;
    }
    label {
      display: block;
      margin: 8px 0 6px;
      font-size: 14px;
      color: #334155;
    }
    .pill { display:inline-flex; align-items:center; gap:6px; padding:6px 10px; border-radius:999px; font-size:13px; }
    .pill.success { background:#E6F9ED; color:#16A34A; }
    .pill.warn { background:#FEF3C7; color:#92400E; }
    .pill.error { background:#FEE2E2; color:#DC2626; }
    .hr {
      height: 1px;
      background: #e2e8f0;
      margin: 12px 0 16px;
    }
    .hidden {
      display: none !important;
    }
    .price {
      font-weight: 700;
      font-size: 16px;
      color: var(--primary);
    }
    .history-list {
      display: grid;
      grid-template-columns: 1fr;
      gap: 10px;
    }
    .h-item {
      border: 1px solid #E2E8F0;
      border-radius: 10px;
      padding: 10px;
      background: var(--surface);
      margin-bottom: 4px;
    }
    .h-head, .h-foot {
      display: flex;
      justify-content: space-between;
      gap: 8px;
    }
    .h-foot {
      margin-top: 6px;
    }
    #status-json pre {
      background: #FAFAFA;
      border: 1px solid #EEE;
      border-radius: 8px;
      font-size: 13px;
      padding: 8px;
      overflow: auto;
      margin: 8px 0 0;
    }
    #pay-sim { display: block !important; }
    #pay-sim.hidden { display: none !important; }
    .paybox { max-height: none !important; opacity: 1 !important; }
    @media (max-width: 600px) {
      main { padding: 8px 4px 16px; }
      .card { padding: 12px; }
      .btn { padding: 10px 8px; font-size: 14px; }
      .title { font-size: 16px; }
      header { padding: 10px 8px; }
    }
  </style>
  <style>
    body.on-form #btn-reload,
    body.on-form #btn-history {
      display: none;
    }
    body.on-form #btn-reload { display: none; }
    #btn-history { display: inline-flex !important; }
  </style>


<style>
  .fab-whatsapp{
  position: fixed;
  right: 20px;
  bottom: 20px;
  width: 56px; height: 56px;
  border-radius: 50%;
  background: #25D366;
  display: flex; align-items: center; justify-content: center;
  box-shadow: 0 4px 8px rgba(0,0,0,.25);
  z-index: 9999;
  text-decoration: none;
}
.fab-whatsapp img{
  width: 28px; height: 28px; display: block;
}

/* Evita que reglas globales estiren el √≠cono */
.fab-whatsapp * { max-width: none !important; max-height: none !important; }

/* Respeta el notch / safe-area en iOS */
@supports(padding:max(0px)){
  .fab-whatsapp{ right: max(20px, env(safe-area-inset-right)); bottom: max(20px, env(safe-area-inset-bottom)); }
}

/* Peque√±o hover (desktop) */
@media (hover:hover){
  .fab-whatsapp:hover{ transform: translateY(-2px); box-shadow: 0 6px 12px rgba(0,0,0,.28); }
}

</style>

</head>
<body>
<header>
  <div class="brand">Tr√°miteYA (Emulador)</div>
  <div class="actions">
    <button id="btn-reload" class="btn secondary">Recargar cat√°logo</button>
    <button id="btn-history" class="btn secondary">Mis solicitudes</button>
  </div>
</header>

<main>

  <!-- LISTA -->
  <section id="screen-list" class="card">
    <h1 class="page-title">Cat√°logo de tr√°mites</h1>
    <div class="hr"></div>
    <div id="services" class="grid"></div>
    <div id="empty" class="muted hidden">No hay tr√°mites disponibles.</div>
    <div class="hr"></div>
    <div id="history" class="">
      <h1 class="page-title">Mis solicitudes (en este dispositivo)</h1>
      <div class="hr"></div>
      <div class="row">
        <div class="muted">Solo visibles en este tel√©fono</div>
        <div class="spacer"></div>
        <button id="btn-clear-history" class="btn ghost">Limpiar historial</button>
      </div>
      <div id="history-list" class="history-list muted"></div>
    </div>
  </section>

  <!-- FORM -->
  <section id="screen-form" class="card hidden">
    <button id="btn-back" class="btn secondary">‚Üê Volver</button>
    <div class="hr"></div>

    <div id="svc-head" class="row">
      <div class="title">Tr√°mite</div>
    </div>

    <!-- Desglose de precio -->
    <div id="price-box" class="pill">
      <div><strong>Desglose</strong></div>
      <div id="price-breakdown" class="muted"></div>
    </div>

    <div class="hr"></div>

    <form id="form"></form>

    <div class="row">
      <div class="muted" id="svc-price">Total: ‚Äî</div>
      <button id="btn-create" class="btn">Crear orden</button>
    </div>

    <div id="pay-sim" class="hidden">
      <div class="hr"></div>
      <div class="paybox card">
        <!-- Simulador de pago (solo emulador) -->
        <details id="simulator">
          <summary style="font-weight:700; cursor:pointer;">üß™ Simulador de pago (s√≥lo emulador)</summary>
          <div class="muted" style="margin:8px 0;">
            Est√°s saliendo de Tr√°miteYA, simulando Wompi. Selecciona un resultado:
          </div>
          <div class="row" style="gap:12px; flex-wrap:wrap;">
            <button class="btn" data-sim="success" style="background:#16a34a">‚úÖ Pago exitoso</button>
            <button class="btn" data-sim="insufficient" style="background:#f59e0b">‚ö†Ô∏è Saldo insuficiente</button>
            <button class="btn" data-sim="canceled" style="background:#475569">‚ùå Cancelado por usuario</button>
            <button class="btn" data-sim="error" style="background:#dc2626">‚ùå Error t√©cnico</button>
          </div>
        </details>
      </div>
    </div>
  </section>

  <!-- ESTADO -->
  <section id="screen-status" class="card hidden">
    <div class="title page-title">Estado de tu solicitud</div>
    <div class="hr"></div>

    <div class="card trust">
      <div class="row">
        <div id="badge-status" class="pill">‚Äî</div>
        <div class="spacer"></div>
        <div class="muted" id="order-date">‚Äî</div>
      </div>
      <div class="summary">
        <div class="row">
          <div>
            <div class="muted">N¬∞ de orden</div>
            <div class="big" id="order-id">‚Äî</div>
          </div>
          <div>
            <div class="muted">Tr√°mite</div>
            <div class="big" id="order-service">‚Äî</div>
          </div>
        </div>
        <div class="row">
          <div>
            <div class="muted">Pago</div>
            <div id="status-payment" class="big">‚Äî</div>
          </div>
          <div>
            <div class="muted">Entrega</div>
            <div id="status-delivery" class="big">‚Äî</div>
          </div>
        </div>
      </div>
    </div>

    <div class="card money">
      <div class="title">Detalle de cobro</div>
      <div class="row money-row"><span>Valor base</span><strong id="price-base">‚Äî</strong></div>
      <div class="row money-row"><span>IVA</span><strong id="price-tax">‚Äî</strong></div>
      <div class="row money-row"><span>Servicio</span><strong id="price-fee">‚Äî</strong></div>
      <div class="hr"></div>
      <div class="row money-row total"><span>Total</span><strong id="price-total">‚Äî</strong></div>
    </div>

    <div class="card info">
      <div class="title">Sigue tu tr√°mite</div>
      <p class="muted" id="friendly-message">‚Äî</p>
      <div class="row">
        <button id="btn-retry" class="btn secondary">Volver al cat√°logo</button>
      </div>
    </div>

    <div class="card debug">
      <div class="title">Detalles t√©cnicos</div>
      <div id="status-json" class="muted"><pre style="background:#fafafa;border:1px solid #eee;padding:8px;border-radius:8px;overflow:auto;font-size:13px"></pre></div>
    </div>
  </section>

</main>

<script src="./main.js"></script>
<!-- FAB WhatsApp -->
<a id="fab-whatsapp"
   class="fab-whatsapp"
   href="https://wa.me/573001234567?text=Hola%20necesito%20ayuda%20con%20Tr%C3%A1miteYA"
   target="_blank" rel="noopener"
   aria-label="Ayuda por WhatsApp">
  <img src="./img/whatsapp.png" alt="WhatsApp">
</a>

</body>
</html>

